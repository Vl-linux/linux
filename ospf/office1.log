[vagrant@office1Router ~]$ systemctl status zebra
● zebra.service - GNU Zebra routing manager
   Loaded: loaded (/usr/lib/systemd/system/zebra.service; disabled; vendor preset: disabled)
   Active: active (running) since Tue 2018-09-11 19:35:02 UTC; 10min ago
  Process: 4431 ExecStart=/usr/sbin/zebra -d $ZEBRA_OPTS -f /etc/quagga/zebra.conf (code=exited, status=0/SUCCESS)
  Process: 4430 ExecStartPre=/sbin/ip route flush proto zebra (code=exited, status=0/SUCCESS)
 Main PID: 4433 (zebra)
   CGroup: /system.slice/zebra.service
           └─4433 /usr/sbin/zebra -d -A 127.0.0.1 -f /etc/quagga/zebra.conf
[vagrant@office1Router ~]$ systemctl status ospfd
● ospfd.service - OSPF routing daemon
   Loaded: loaded (/usr/lib/systemd/system/ospfd.service; disabled; vendor preset: disabled)
   Active: active (running) since Tue 2018-09-11 19:35:02 UTC; 10min ago
  Process: 4435 ExecStart=/usr/sbin/ospfd -d $OSPFD_OPTS -f /etc/quagga/ospfd.conf (code=exited, status=0/SUCCESS)
 Main PID: 4436 (ospfd)
   CGroup: /system.slice/ospfd.service
           └─4436 /usr/sbin/ospfd -d -A 127.0.0.1 -f /etc/quagga/ospfd.conf
[vagrant@office1Router ~]$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 52:54:00:c9:c7:04 brd ff:ff:ff:ff:ff:ff
    inet 10.0.2.15/24 brd 10.0.2.255 scope global noprefixroute dynamic eth0
       valid_lft 85659sec preferred_lft 85659sec
    inet6 fe80::5054:ff:fec9:c704/64 scope link 
       valid_lft forever preferred_lft forever
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 08:00:27:0d:58:55 brd ff:ff:ff:ff:ff:ff
    inet6 fe80::846a:6bf0:4731:c333/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
4: eth2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 08:00:27:28:b7:4d brd ff:ff:ff:ff:ff:ff
    inet6 fe80::7a6d:a0cd:5988:3aa6/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
5: eth3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 08:00:27:ba:94:5c brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.1/26 brd 192.168.1.63 scope global noprefixroute eth3
       valid_lft forever preferred_lft forever
    inet6 fe80::a00:27ff:feba:945c/64 scope link 
       valid_lft forever preferred_lft forever
6: eth1.1@eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether 08:00:27:0d:58:55 brd ff:ff:ff:ff:ff:ff
    inet 10.10.0.2/30 brd 10.10.0.3 scope global eth1.1
       valid_lft forever preferred_lft forever
    inet6 fe80::a00:27ff:fe0d:5855/64 scope link 
       valid_lft forever preferred_lft forever
7: eth2.2@eth2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether 08:00:27:28:b7:4d brd ff:ff:ff:ff:ff:ff
    inet 10.10.0.5/30 brd 10.10.0.7 scope global eth2.2
       valid_lft forever preferred_lft forever
    inet6 fe80::a00:27ff:fe28:b74d/64 scope link 
       valid_lft forever preferred_lft forever
[vagrant@office1Router ~]$ sudo cat /etc/quagga/zebra.conf
hostname office1Router
log file /var/log/zebra.log
log monitor
log stdout
log syslog
interface eth3
ip address 192.168.1.1/26
interface eth1.1
ip address 10.10.0.2/30
interface eth2.2
ip address 10.10.0.5/30
[vagrant@office1Router ~]$ sudo cat /etc/quagga/ospfd.conf
hostname office1Router

router ospf
ospf router-id 10.10.0.2
 network 10.10.0.0/30 area 0
 network 10.10.0.4/30 area 0
 network 192.168.1.0/26 area 3
 redistribute connected


log file /var/log/ospfd.log
[vagrant@office1Router ~]$ 
[vagrant@office1Router ~]$ tracepath 192.168.0.1
 1?: [LOCALHOST]                                         pmtu 1500
 1:  192.168.0.1                                           2.087ms reached
 1:  192.168.0.1                                           1.023ms reached
     Resume: pmtu 1500 hops 1 back 1 
[vagrant@office1Router ~]$ tracepath 192.168.2.1
 1?: [LOCALHOST]                                         pmtu 1500
 1:  192.168.2.1                                           1.613ms reached
 1:  192.168.2.1                                           2.644ms reached
     Resume: pmtu 1500 hops 1 back 1 
[vagrant@office1Router ~]$ 
[vagrant@office1Router ~]$ sudo sysctl -a | grep rp_filt
net.ipv4.conf.all.arp_filter = 0
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.arp_filter = 0
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.eth0.arp_filter = 0
net.ipv4.conf.eth0.rp_filter = 1
net.ipv4.conf.eth1.arp_filter = 0
net.ipv4.conf.eth1.rp_filter = 1
net.ipv4.conf.eth1/1.arp_filter = 0
net.ipv4.conf.eth1/1.rp_filter = 1
net.ipv4.conf.eth2.arp_filter = 0
sysctl: reading key "net.ipv6.conf.all.stable_secret"
sysctl: reading key "net.ipv6.conf.default.stable_secret"
net.ipv4.conf.eth2.rp_filter = 1
net.ipv4.conf.eth2/2.arp_filter = 0
net.ipv4.conf.eth2/2.rp_filter = 1
net.ipv4.conf.eth3.arp_filter = 0
net.ipv4.conf.eth3.rp_filter = 1
net.ipv4.conf.lo.arp_filter = 0
net.ipv4.conf.lo.rp_filter = 0
sysctl: reading key "net.ipv6.conf.eth0.stable_secret"
sysctl: reading key "net.ipv6.conf.eth1.stable_secret"
sysctl: reading key "net.ipv6.conf.eth1/1.stable_secret"
sysctl: reading key "net.ipv6.conf.eth2.stable_secret"
sysctl: reading key "net.ipv6.conf.eth2/2.stable_secret"
sysctl: reading key "net.ipv6.conf.eth3.stable_secret"
sysctl: reading key "net.ipv6.conf.lo.stable_secret"
[vagrant@office1Router ~]$ sudo sysctl net.ipv4.conf.all.rp_filter
net.ipv4.conf.all.rp_filter = 1
[vagrant@office1Router ~]$ sudo sysctl net.ipv4.conf.default.rp_filter
net.ipv4.conf.default.rp_filter = 1
[vagrant@office1Router ~]$ sudo sysctl net.ipv4.conf.eth1/1.rp_filter
net.ipv4.conf.eth1/1.rp_filter = 1
[vagrant@office1Router ~]$ sudo sysctl net.ipv4.conf.eth2/2.rp_filter
net.ipv4.conf.eth2/2.rp_filter = 1
[vagrant@office1Router ~]$ 
[vagrant@office1Router ~]$ ping 192.168.0.1
PING 192.168.0.1 (192.168.0.1) 56(84) bytes of data.
64 bytes from 192.168.0.1: icmp_seq=1 ttl=64 time=1.00 ms
64 bytes from 192.168.0.1: icmp_seq=2 ttl=64 time=1.16 ms
^C
--- 192.168.0.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1002ms
rtt min/avg/max/mdev = 1.006/1.084/1.162/0.078 ms
[vagrant@office1Router ~]$ ping 192.168.2.1
PING 192.168.2.1 (192.168.2.1) 56(84) bytes of data.
64 bytes from 192.168.2.1: icmp_seq=1 ttl=64 time=1.11 ms
64 bytes from 192.168.2.1: icmp_seq=2 ttl=64 time=1.11 ms
64 bytes from 192.168.2.1: icmp_seq=3 ttl=64 time=0.978 ms
^C
--- 192.168.2.1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2005ms
rtt min/avg/max/mdev = 0.978/1.068/1.115/0.074 ms
[vagrant@office1Router ~]$ tracepath 192.168.0.1
 1?: [LOCALHOST]                                         pmtu 1500
 1:  192.168.0.1                                           1.708ms reached
 1:  192.168.0.1                                           1.044ms reached
     Resume: pmtu 1500 hops 1 back 1 
[vagrant@office1Router ~]$ tracepath 192.168.2.1
 1?: [LOCALHOST]                                         pmtu 1500
 1:  192.168.2.1                                           1.448ms reached
 1:  192.168.2.1                                           2.038ms reached
     Resume: pmtu 1500 hops 1 back 1 
[vagrant@office1Router ~]$ tracepath 192.168.2.1
 1?: [LOCALHOST]                                         pmtu 1500
 1:  192.168.2.1                                           1.526ms reached
 1:  192.168.2.1                                           1.002ms reached
     Resume: pmtu 1500 hops 1 back 1 
[vagrant@office1Router ~]$ tracepath 192.168.0.1
 1?: [LOCALHOST]                                         pmtu 1500
 1:  192.168.0.1                                           0.378ms reached
 1:  192.168.0.1                                           0.664ms reached
     Resume: pmtu 1500 hops 1 back 1 
[vagrant@office1Router ~]$ sudo vtysh -c 'show ip route 192.168.0.1'
Routing entry for 192.168.0.0/28
  Known via "ospf", distance 110, metric 20, best
  Last update 00:19:54 ago
  * 10.10.0.1, via eth1.1

[vagrant@office1Router ~]$ sudo vtysh -c 'show ip route 192.168.2.1'
Routing entry for 192.168.2.0/25
  Known via "ospf", distance 110, metric 20, best
  Last update 00:22:03 ago
  * 10.10.0.6, via eth2.2

[vagrant@office1Router ~]$ 
[vagrant@office1Router ~]$ sudo systemctl start zebra
[vagrant@office1Router ~]$ sudo systemctl start ospfd
[vagrant@office1Router ~]$ sudo systemctl status zebra ospfd
● zebra.service - GNU Zebra routing manager
   Loaded: loaded (/usr/lib/systemd/system/zebra.service; disabled; vendor preset: disabled)
   Active: active (running) since Tue 2018-09-11 20:55:40 UTC; 13s ago
  Process: 9045 ExecStart=/usr/sbin/zebra -d $ZEBRA_OPTS -f /etc/quagga/zebra.conf (code=exited, status=0/SUCCESS)
  Process: 9044 ExecStartPre=/sbin/ip route flush proto zebra (code=exited, status=0/SUCCESS)
 Main PID: 9048 (zebra)
   CGroup: /system.slice/zebra.service
           └─9048 /usr/sbin/zebra -d -A 127.0.0.1 -f /etc/quagga/zebra.conf

Sep 11 20:55:40 office1Router systemd[1]: Starting GNU Zebra routing manager...
Sep 11 20:55:40 office1Router zebra[9045]: 2018/09/11 20:55:40 ZEBRA: buffer_flush_available: write error on fd 0: Bad file descriptor
Sep 11 20:55:40 office1Router systemd[1]: PID file /run/quagga/zebra.pid not readable (yet?) after start.
Sep 11 20:55:40 office1Router zebra[9048]: Zebra 0.99.22.4 starting: vty@2601
Sep 11 20:55:40 office1Router systemd[1]: Started GNU Zebra routing manager.
Sep 11 20:55:46 office1Router zebra[9048]: client 15 says hello and bids fair to announce only ospf routes

● ospfd.service - OSPF routing daemon
   Loaded: loaded (/usr/lib/systemd/system/ospfd.service; disabled; vendor preset: disabled)
   Active: active (running) since Tue 2018-09-11 20:55:46 UTC; 7s ago
  Process: 9060 ExecStart=/usr/sbin/ospfd -d $OSPFD_OPTS -f /etc/quagga/ospfd.conf (code=exited, status=0/SUCCESS)
 Main PID: 9061 (ospfd)
   CGroup: /system.slice/ospfd.service
           └─9061 /usr/sbin/ospfd -d -A 127.0.0.1 -f /etc/quagga/ospfd.conf

Sep 11 20:55:46 office1Router systemd[1]: Starting OSPF routing daemon...
Sep 11 20:55:46 office1Router systemd[1]: PID file /run/quagga/ospfd.pid not readable (yet?) after start.
Sep 11 20:55:46 office1Router systemd[1]: Started OSPF routing daemon.
[vagrant@office1Router ~]$ tracepath 192.168.0.1
 1?: [LOCALHOST]                                         pmtu 1500
 1:  10.10.0.6                                             1.597ms 
 1:  10.10.0.6                                             1.527ms 
 2:  192.168.0.1                                           0.754ms reached
     Resume: pmtu 1500 hops 2 back 2 
[vagrant@office1Router ~]$ tracepath 192.168.2.1
 1?: [LOCALHOST]                                         pmtu 1500
 1:  192.168.2.1                                           1.586ms reached
 1:  192.168.2.1                                           2.401ms reached
     Resume: pmtu 1500 hops 1 back 1 
[vagrant@office1Router ~]$ sudo vtysh -c 'show ip route 192.168.0.1'
Routing entry for 192.168.0.0/28
  Known via "ospf", distance 110, metric 30, best
  Last update 00:02:30 ago
  * 10.10.0.6, via eth2.2

[vagrant@office1Router ~]$ sudo vtysh -c 'show ip route 192.168.2.1'
Routing entry for 192.168.2.0/25
  Known via "ospf", distance 110, metric 20, best
  Last update 00:02:38 ago
  * 10.10.0.6, via eth2.2

[vagrant@office1Router ~]$ sudo cat /etc/quagga/zebra.conf
hostname office1Router
log file /var/log/zebra.log
log monitor
log stdout
log syslog
interface eth3
ip address 192.168.1.1/26
interface eth1.1
ip address 10.10.0.2/30
interface eth2.2
ip address 10.10.0.5/30
[vagrant@office1Router ~]$ sudo cat /etc/quagga/ospfd.conf
hostname office1Router

router ospf
ospf router-id 10.10.0.2
 network 10.10.0.0/30 area 0
 network 10.10.0.4/30 area 0
 network 192.168.1.0/26 area 3
 redistribute connected

interface eth1.1
ip ospf cost 100

log file /var/log/ospfd.log
[vagrant@office1Router ~]$ 

[vagrant@office1Router ~]$
